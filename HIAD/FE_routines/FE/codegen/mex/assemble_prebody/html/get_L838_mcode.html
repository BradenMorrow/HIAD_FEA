<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="152,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T162U3">L</span>] = get_L(<span class="var type1" id="S3T72U6">rk</span>,<span class="var type1" id="S4T72U7">e1</span>,<span class="var type1" id="S5T7U8">l</span>,<span class="var type1" id="S6T72U9">r1</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="152,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%GET_L</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Get the L matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T73:U6"><span class="var type1" id="S7T73U12">A</span> = <span class="mxinfo " id="T73:U8"><span class="mxinfo " id="T7:U9"><span class="mxinfo " id="T7:U10">1</span>/<span class="var type1" id="S5T7U16">l</span></span>*(<span class="mxinfo " id="T73:U12"><span class="mxinfo " id="T73:U13">[<span class="mxinfo " id="T5:U14">1 0 0</span>; <span class="mxinfo " id="T5:U15">0 1 0</span>; <span class="mxinfo " id="T5:U16">0 0 1</span>]</span> - <span class="mxinfo " id="T73:U17"><span class="var type1" id="S4T72U33">e1</span>*<span class="mxinfo " id="T5:U19"><span class="var type1" id="S4T72U35">e1</span>'</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% Srk = get_S(rk);</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Sr1 = get_S(r1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,11" id="srcline11">11</a></span><span class="line"><span class="comment">% Replace get_S with built in code to improve performance</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T73:U21"><span class="var type1" id="S8T73U38">Srk</span> = <span class="mxinfo " id="T73:U23">[0 0 0; 0 0 0; 0 0 0]</span></span>; <span class="comment">%replace zeros(3) with explicit definition to improve performance</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T7:U24"><span class="mxinfo " id="T7:U25"><span class="var type1" id="S8T73U55">Srk</span>(<span class="mxinfo " id="T49:U27">2</span>,<span class="mxinfo " id="T49:U28">1</span>)</span> = <span class="mxinfo " id="T7:U29"><span class="var type1" id="S3T72U59">rk</span>(<span class="mxinfo " id="T49:U31">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T7:U32"><span class="mxinfo " id="T7:U33"><span class="var type1" id="S8T73U64">Srk</span>(<span class="mxinfo " id="T49:U35">3</span>,<span class="mxinfo " id="T49:U36">1</span>)</span> = <span class="mxinfo " id="T7:U37">-<span class="mxinfo " id="T7:U38"><span class="var type1" id="S3T72U69">rk</span>(<span class="mxinfo " id="T49:U40">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T7:U41"><span class="mxinfo " id="T7:U42"><span class="var type1" id="S8T73U74">Srk</span>(<span class="mxinfo " id="T49:U44">1</span>,<span class="mxinfo " id="T49:U45">2</span>)</span> = <span class="mxinfo " id="T7:U46">-<span class="mxinfo " id="T7:U47"><span class="var type1" id="S3T72U79">rk</span>(<span class="mxinfo " id="T49:U49">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T7:U50"><span class="mxinfo " id="T7:U51"><span class="var type1" id="S8T73U84">Srk</span>(<span class="mxinfo " id="T49:U53">3</span>,<span class="mxinfo " id="T49:U54">2</span>)</span> = <span class="mxinfo " id="T7:U55"><span class="var type1" id="S3T72U88">rk</span>(<span class="mxinfo " id="T49:U57">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T7:U58"><span class="mxinfo " id="T7:U59"><span class="var type1" id="S8T73U93">Srk</span>(<span class="mxinfo " id="T49:U61">1</span>,<span class="mxinfo " id="T49:U62">3</span>)</span> = <span class="mxinfo " id="T7:U63"><span class="var type1" id="S3T72U97">rk</span>(<span class="mxinfo " id="T49:U65">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T7:U66"><span class="mxinfo " id="T7:U67"><span class="var type1" id="S8T73U102">Srk</span>(<span class="mxinfo " id="T49:U69">2</span>,<span class="mxinfo " id="T49:U70">3</span>)</span> = <span class="mxinfo " id="T7:U71">-<span class="mxinfo " id="T7:U72"><span class="var type1" id="S3T72U107">rk</span>(<span class="mxinfo " id="T49:U74">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T73:U75"><span class="var type1" id="S9T73U111">Sr1</span> = <span class="mxinfo " id="T73:U77">[0 0 0; 0 0 0; 0 0 0]</span></span>; <span class="comment">%replace zeros(3) with explicit definition to improve performance</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T7:U78"><span class="mxinfo " id="T7:U79"><span class="var type1" id="S9T73U128">Sr1</span>(<span class="mxinfo " id="T49:U81">2</span>,<span class="mxinfo " id="T49:U82">1</span>)</span> = <span class="mxinfo " id="T7:U83"><span class="var type1" id="S6T72U132">r1</span>(<span class="mxinfo " id="T49:U85">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T7:U86"><span class="mxinfo " id="T7:U87"><span class="var type1" id="S9T73U137">Sr1</span>(<span class="mxinfo " id="T49:U89">3</span>,<span class="mxinfo " id="T49:U90">1</span>)</span> = <span class="mxinfo " id="T7:U91">-<span class="mxinfo " id="T7:U92"><span class="var type1" id="S6T72U142">r1</span>(<span class="mxinfo " id="T49:U94">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T7:U95"><span class="mxinfo " id="T7:U96"><span class="var type1" id="S9T73U147">Sr1</span>(<span class="mxinfo " id="T49:U98">1</span>,<span class="mxinfo " id="T49:U99">2</span>)</span> = <span class="mxinfo " id="T7:U100">-<span class="mxinfo " id="T7:U101"><span class="var type1" id="S6T72U152">r1</span>(<span class="mxinfo " id="T49:U103">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T7:U104"><span class="mxinfo " id="T7:U105"><span class="var type1" id="S9T73U157">Sr1</span>(<span class="mxinfo " id="T49:U107">3</span>,<span class="mxinfo " id="T49:U108">2</span>)</span> = <span class="mxinfo " id="T7:U109"><span class="var type1" id="S6T72U161">r1</span>(<span class="mxinfo " id="T49:U111">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T7:U112"><span class="mxinfo " id="T7:U113"><span class="var type1" id="S9T73U166">Sr1</span>(<span class="mxinfo " id="T49:U115">1</span>,<span class="mxinfo " id="T49:U116">3</span>)</span> = <span class="mxinfo " id="T7:U117"><span class="var type1" id="S6T72U170">r1</span>(<span class="mxinfo " id="T49:U119">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T7:U120"><span class="mxinfo " id="T7:U121"><span class="var type1" id="S9T73U175">Sr1</span>(<span class="mxinfo " id="T49:U123">2</span>,<span class="mxinfo " id="T49:U124">3</span>)</span> = <span class="mxinfo " id="T7:U125">-<span class="mxinfo " id="T7:U126"><span class="var type1" id="S6T72U180">r1</span>(<span class="mxinfo " id="T49:U128">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,29" id="srcline29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T73:U129"><span class="var type1" id="S10T73U184">L1</span> = <span class="mxinfo " id="T73:U131"><span class="mxinfo " id="T73:U132"><span class="mxinfo " id="T73:U133"><span class="mxinfo " id="T7:U134"><span class="mxinfo " id="T5:U135"><span class="var type1" id="S3T72U190">rk</span>'</span>*<span class="var type1" id="S4T72U191">e1</span></span>*<span class="var type1" id="S7T73U192">A</span></span>/<span class="mxinfo " id="T7:U139">2</span></span> + <span class="mxinfo " id="T73:U140"><span class="mxinfo " id="T73:U141"><span class="mxinfo " id="T72:U142"><span class="var type1" id="S7T73U197">A</span>*<span class="var type1" id="S3T72U198">rk</span></span>*<span class="mxinfo " id="T5:U145">(<span class="mxinfo " id="T72:U146"><span class="var type1" id="S4T72U202">e1</span> + <span class="var type1" id="S6T72U203">r1</span></span>)'</span></span>/<span class="mxinfo " id="T7:U149">2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T73:U150"><span class="var type1" id="S11T73U207">L2</span> = <span class="mxinfo " id="T73:U152"><span class="mxinfo " id="T73:U153"><span class="mxinfo " id="T73:U154"><span class="var type1" id="S8T73U211">Srk</span>/<span class="mxinfo " id="T7:U156">2</span></span> - <span class="mxinfo " id="T73:U157"><span class="mxinfo " id="T73:U158"><span class="mxinfo " id="T7:U159"><span class="mxinfo " id="T5:U160"><span class="var type1" id="S3T72U217">rk</span>'</span>*<span class="var type1" id="S4T72U218">e1</span></span>*<span class="var type1" id="S9T73U219">Sr1</span></span>/<span class="mxinfo " id="T7:U164">4</span></span></span> - <span class="mxinfo " id="T73:U165"><span class="mxinfo " id="T73:U166"><span class="mxinfo " id="T72:U167"><span class="var type1" id="S8T73U224">Srk</span>*<span class="var type1" id="S4T72U225">e1</span></span>*<span class="mxinfo " id="T5:U170">(<span class="mxinfo " id="T72:U171"><span class="var type1" id="S4T72U229">e1</span> + <span class="var type1" id="S6T72U230">r1</span></span>)'</span></span>/<span class="mxinfo " id="T7:U174">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T162:U175"><span class="var type1" id="S2T162U234">L</span> = <span class="mxinfo " id="T162:U177">[<span class="var type1" id="S10T73U237">L1</span>; <span class="var type1" id="S11T73U239">L2</span>; <span class="mxinfo " id="T73:U180">-<span class="var type1" id="S10T73U242">L1</span></span>; <span class="var type1" id="S11T73U244">L2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,36" id="srcline36">36</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,37" id="srcline37">37</a></span><span class="line"></span></span>
</pre>
