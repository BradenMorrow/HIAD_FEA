<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="97,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T73U3">R</span>] = get_R_PHI(<span class="var type1" id="S3T72U6">PHI</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="97,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%GET_R_PHI</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Get rotation matrix from rotation vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T7:U3"><span class="var type1" id="S4T7U9">phi</span> = <span class="mxinfo " id="T7:U5">norm(<span class="var type1" id="S3T72U12">PHI</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="97,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T73:U7"><span class="var type1" id="S6T73U15">S_PHI</span> = <span class="mxinfo " id="T73:U9"><span class="fcn" id="F223N19:B17">get_S</span>(<span class="var type1" id="S3T72U18">PHI</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="97,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T73:U11"><span class="var type1" id="S8T73U21">S_PHI2</span> = <span class="mxinfo " id="T73:U13"><span class="mxinfo " id="T73:U14"><span class="var type1" id="S3T72U24">PHI</span>*<span class="mxinfo " id="T5:U16"><span class="var type1" id="S3T72U26">PHI</span>'</span></span> - <span class="mxinfo " id="T73:U18">(<span class="mxinfo " id="T7:U19"><span class="mxinfo " id="T5:U20"><span class="var type1" id="S3T72U31">PHI</span>'</span>*<span class="var type1" id="S3T72U32">PHI</span></span>)*<span class="mxinfo " id="T73:U23">eye(3)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="97,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% % % w = 2*tan(phi/2)/phi*PHI; %[S_PHI(3,2) S_PHI(1,3) S_PHI(2,1)]';</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,10" id="srcline10">10</a></span><span class="line"><span class="comment">% % % S_w = get_S(w);</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,11" id="srcline11">11</a></span><span class="line"><span class="comment">% % % S_w2 = w*w' - norm(w)*eye(3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,12" id="srcline12">12</a></span><span class="line"><span class="comment">% % % </span></span></span>
<span class="srcline"><span class="lineno"><a href="97,13" id="srcline13">13</a></span><span class="line"><span class="comment">% % % R = eye(3) + 1/(1 + (w'*w)/4)*(S_w + S_w2/2); % (3.36)</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T73:U24"><span class="var type1" id="S2T73U38">R</span> = <span class="mxinfo " id="T73:U26"><span class="mxinfo " id="T73:U27"><span class="mxinfo " id="T73:U28">eye(3)</span> + <span class="mxinfo " id="T73:U29"><span class="mxinfo " id="T7:U30"><span class="mxinfo " id="T7:U31">sin(<span class="var type1" id="S4T7U48">phi</span>)</span>/<span class="var type1" id="S4T7U49">phi</span></span>*<span class="var type1" id="S6T73U50">S_PHI</span></span></span> + <span class="mxinfo " id="T73:U35"><span class="mxinfo " id="T7:U36">(<span class="mxinfo " id="T7:U37"><span class="mxinfo " id="T7:U38">1</span> - <span class="mxinfo " id="T7:U39">cos(<span class="var type1" id="S4T7U58">phi</span>)</span></span>)/<span class="mxinfo " id="T7:U41"><span class="var type1" id="S4T7U60">phi</span>^2</span></span>*<span class="var type1" id="S8T73U62">S_PHI2</span></span></span></span>; <span class="comment">% (3.21)</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T73:U44"><span class="var type1" id="S2T73U65">R</span> = <span class="mxinfo " id="T73:U46"><span class="fcn" id="F346N24:B67">normcfast</span>(<span class="var type1" id="S2T73U68">R</span>)</span></span>; <span class="comment">%improved performanc time <span class="keyword">...</span><span class="comment"> does not do unecissary operations</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="97,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,19" id="srcline19">19</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T28:U48"><span class="mxinfo " id="T7:U49">norm(<span class="var type1" id="S3T72U75">PHI</span>)</span> == <span class="mxinfo " id="T7:U51">0</span></span> || <span class="mxinfo " id="T28:U52">isnan(<span class="mxinfo " id="T7:U53">norm(<span class="var type1" id="S3T72U81">PHI</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T73:U55"><span class="var type1" id="S2T73U84">R</span> = <span class="mxinfo " id="T73:U57">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="97,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="97,23" id="srcline23">23</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="97,24" id="srcline24">24</a></span><span class="line"></span></span>
</pre>
