<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="159,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T163U3">T</span>] = T_beam_3d(<span class="var type1" id="S3T4U6">nodes</span>,<span class="var type1" id="S4T5U7">orient</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="159,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%T_BEAM_3D</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Generate the transformation matrix for a 3D beam element;</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Length of element</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T7:U4"><span class="var type1" id="S5T7U10">L_x</span> = <span class="mxinfo " id="T7:U6"><span class="mxinfo " id="T7:U7"><span class="var type1" id="S3T4U13">nodes</span>(<span class="mxinfo " id="T49:U9">2</span>,<span class="mxinfo " id="T49:U10">1</span>)</span> - <span class="mxinfo " id="T7:U11"><span class="var type1" id="S3T4U17">nodes</span>(<span class="mxinfo " id="T7:U13">1</span>,<span class="mxinfo " id="T7:U14">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T7:U15"><span class="var type1" id="S6T7U22">L_y</span> = <span class="mxinfo " id="T7:U17"><span class="mxinfo " id="T7:U18"><span class="var type1" id="S3T4U25">nodes</span>(<span class="mxinfo " id="T49:U20">2</span>,<span class="mxinfo " id="T49:U21">2</span>)</span> - <span class="mxinfo " id="T7:U22"><span class="var type1" id="S3T4U29">nodes</span>(<span class="mxinfo " id="T7:U24">1</span>,<span class="mxinfo " id="T7:U25">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T7:U26"><span class="var type1" id="S7T7U34">L_z</span> = <span class="mxinfo " id="T7:U28"><span class="mxinfo " id="T7:U29"><span class="var type1" id="S3T4U37">nodes</span>(<span class="mxinfo " id="T49:U31">2</span>,<span class="mxinfo " id="T49:U32">3</span>)</span> - <span class="mxinfo " id="T7:U33"><span class="var type1" id="S3T4U41">nodes</span>(<span class="mxinfo " id="T7:U35">1</span>,<span class="mxinfo " id="T7:U36">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,10" id="srcline10">10</a></span><span class="line"><span class="comment">% Vector to orientation node</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T7:U37"><span class="var type1" id="S8T7U46">L_xo</span> = <span class="mxinfo " id="T7:U39"><span class="mxinfo " id="T7:U40"><span class="var type1" id="S4T5U49">orient</span>(<span class="mxinfo " id="T49:U42">1</span>,<span class="mxinfo " id="T49:U43">1</span>)</span> - <span class="mxinfo " id="T7:U44"><span class="var type1" id="S3T4U53">nodes</span>(<span class="mxinfo " id="T7:U46">1</span>,<span class="mxinfo " id="T7:U47">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T7:U48"><span class="var type1" id="S9T7U58">L_yo</span> = <span class="mxinfo " id="T7:U50"><span class="mxinfo " id="T7:U51"><span class="var type1" id="S4T5U61">orient</span>(<span class="mxinfo " id="T49:U53">1</span>,<span class="mxinfo " id="T49:U54">2</span>)</span> - <span class="mxinfo " id="T7:U55"><span class="var type1" id="S3T4U65">nodes</span>(<span class="mxinfo " id="T7:U57">1</span>,<span class="mxinfo " id="T7:U58">2</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T7:U59"><span class="var type1" id="S10T7U70">L_zo</span> = <span class="mxinfo " id="T7:U61"><span class="mxinfo " id="T7:U62"><span class="var type1" id="S4T5U73">orient</span>(<span class="mxinfo " id="T49:U64">1</span>,<span class="mxinfo " id="T49:U65">3</span>)</span> - <span class="mxinfo " id="T7:U66"><span class="var type1" id="S3T4U77">nodes</span>(<span class="mxinfo " id="T7:U68">1</span>,<span class="mxinfo " id="T7:U69">3</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,14" id="srcline14">14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,15" id="srcline15">15</a></span><span class="line"><span class="comment">% Unit vectors</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,16" id="srcline16">16</a></span><span class="line"><span class="comment">% Global</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T72:U70"><span class="var type1" id="S11T72U82">x</span> = <span class="mxinfo " id="T72:U72">[1 0 0]'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T72:U73"><span class="var type1" id="S12T72U91">y</span> = <span class="mxinfo " id="T72:U75">[0 1 0]'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T72:U76"><span class="var type1" id="S13T72U100">z</span> = <span class="mxinfo " id="T72:U78">[0 0 1]'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,21" id="srcline21">21</a></span><span class="line"><span class="comment">% Local</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T72:U79"><span class="var type1" id="S14T72U109">xp</span> = <span class="mxinfo " id="T72:U81"><span class="mxinfo " id="T5:U82">[<span class="var type1" id="S5T7U113">L_x</span> <span class="var type1" id="S6T7U114">L_y</span> <span class="var type1" id="S7T7U115">L_z</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T72:U86"><span class="var type1" id="S14T72U118">xp</span> = <span class="mxinfo " id="T72:U88"><span class="var type1" id="S14T72U120">xp</span>/<span class="mxinfo " id="T7:U90">norm(<span class="var type1" id="S14T72U123">xp</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T72:U92"><span class="var type1" id="S16T72U126">zp</span> = <span class="mxinfo " id="T72:U94">cross(<span class="var type1" id="S14T72U129">xp</span>,<span class="mxinfo " id="T72:U96"><span class="mxinfo " id="T5:U97">[<span class="var type1" id="S8T7U133">L_xo</span> <span class="var type1" id="S9T7U134">L_yo</span> <span class="var type1" id="S10T7U135">L_zo</span>]</span>'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T72:U101"><span class="var type1" id="S16T72U138">zp</span> = <span class="mxinfo " id="T72:U103"><span class="var type1" id="S16T72U140">zp</span>/<span class="mxinfo " id="T7:U105">norm(<span class="var type1" id="S16T72U143">zp</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T72:U107"><span class="var type1" id="S18T72U146">yp</span> = <span class="mxinfo " id="T72:U109">cross(<span class="var type1" id="S16T72U149">zp</span>,<span class="var type1" id="S14T72U150">xp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T72:U112"><span class="var type1" id="S18T72U153">yp</span> = <span class="mxinfo " id="T72:U114"><span class="var type1" id="S18T72U155">yp</span>/<span class="mxinfo " id="T7:U116">norm(<span class="var type1" id="S18T72U158">yp</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,31" id="srcline31">31</a></span><span class="line"><span class="comment">% Direction cosines matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T73:U118"><span class="var type1" id="S19T73U161">lambda</span> = <span class="mxinfo " id="T73:U120">[<span class="mxinfo " id="T5:U121"><span class="mxinfo " id="T7:U122"><span class="mxinfo " id="T5:U123"><span class="var type1" id="S11T72U166">x</span>'</span>*<span class="var type1" id="S14T72U167">xp</span></span> <span class="mxinfo " id="T7:U126"><span class="mxinfo " id="T5:U127"><span class="var type1" id="S12T72U170">y</span>'</span>*<span class="var type1" id="S14T72U171">xp</span></span> <span class="mxinfo " id="T7:U130"><span class="mxinfo " id="T5:U131"><span class="var type1" id="S13T72U174">z</span>'</span>*<span class="var type1" id="S14T72U175">xp</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="159,33" id="srcline33">33</a></span><span class="line">    <span class="mxinfo " id="T5:U134"><span class="mxinfo " id="T7:U135"><span class="mxinfo " id="T5:U136"><span class="var type1" id="S11T72U179">x</span>'</span>*<span class="var type1" id="S18T72U180">yp</span></span> <span class="mxinfo " id="T7:U139"><span class="mxinfo " id="T5:U140"><span class="var type1" id="S12T72U183">y</span>'</span>*<span class="var type1" id="S18T72U184">yp</span></span> <span class="mxinfo " id="T7:U143"><span class="mxinfo " id="T5:U144"><span class="var type1" id="S13T72U187">z</span>'</span>*<span class="var type1" id="S18T72U188">yp</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="159,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T5:U147"><span class="mxinfo " id="T7:U148"><span class="mxinfo " id="T5:U149"><span class="var type1" id="S11T72U192">x</span>'</span>*<span class="var type1" id="S16T72U193">zp</span></span> <span class="mxinfo " id="T7:U152"><span class="mxinfo " id="T5:U153"><span class="var type1" id="S12T72U196">y</span>'</span>*<span class="var type1" id="S16T72U197">zp</span></span> <span class="mxinfo " id="T7:U156"><span class="mxinfo " id="T5:U157"><span class="var type1" id="S13T72U200">z</span>'</span>*<span class="var type1" id="S16T72U201">zp</span></span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,36" id="srcline36">36</a></span><span class="line"><span class="comment">% Assemble transformation matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T73:U160"><span class="var type1" id="S20T73U204">T_zero</span> = <span class="mxinfo " id="T73:U162">zeros(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T163:U163"><span class="var type1" id="S2T163U210">T</span> = <span class="mxinfo " id="T163:U165">[<span class="mxinfo " id="T171:U166"><span class="var type1" id="S19T73U213">lambda</span> <span class="var type1" id="S20T73U214">T_zero</span> <span class="var type1" id="S20T73U215">T_zero</span> <span class="var type1" id="S20T73U216">T_zero</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="159,39" id="srcline39">39</a></span><span class="line">    <span class="mxinfo " id="T171:U171"><span class="var type1" id="S20T73U218">T_zero</span> <span class="var type1" id="S19T73U219">lambda</span> <span class="var type1" id="S20T73U220">T_zero</span> <span class="var type1" id="S20T73U221">T_zero</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="159,40" id="srcline40">40</a></span><span class="line">    <span class="mxinfo " id="T171:U176"><span class="var type1" id="S20T73U223">T_zero</span> <span class="var type1" id="S20T73U224">T_zero</span> <span class="var type1" id="S19T73U225">lambda</span> <span class="var type1" id="S20T73U226">T_zero</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="159,41" id="srcline41">41</a></span><span class="line">    <span class="mxinfo " id="T171:U181"><span class="var type1" id="S20T73U228">T_zero</span> <span class="var type1" id="S20T73U229">T_zero</span> <span class="var type1" id="S20T73U230">T_zero</span> <span class="var type1" id="S19T73U231">lambda</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="159,42" id="srcline42">42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="159,43" id="srcline43">43</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="159,44" id="srcline44">44</a></span><span class="line"></span></span>
</pre>
